### 迁移GitLab仓库并配置公司CICD系统
##### T 20.06.04

```
本来今晚并没有准备迁移，最近的项目紧，准备下周开始的，
然而公司网络发生了故障，导致今晚的GitLab系统无法构建，
没法发布上线，所以不得已加班搞迁移，虽然不是我手上的项目，
但也是我们财务组的活
```

```
我扫了一遍迁移文档，只需要管理员权限在CICD系统里面创建项目，
然后填好老的GitLab的地址，就会自动开始迁移工作
具体可以迁移代码，分支，issue，history等，基本上可以完整的迁移过来了

迁移完成后就需要配置环境了，分为sit、test、prd环境，不同的环境拉取不同分支对应的代码就好了，

关键是分支构建，因为之前是runner构建，迁移过来后可以选择继续runner构建，
也可以选择CICD构建，CICD构建的话就需要把环境变量写入到webpack里面，process.env，需要JSON.stringfy()一下

然后配置CI，这部分其实我没参与，因为已经配好了，
看了一眼，主要是CICD平台的基本参数填入
然后是package.json里面新增一行命令，执行三个步骤
1，npm run build
2，mkdir build
3，cp -a dist index.html

下一步配置dockfile，主要是生成构建的执行流程
接下来配下nginx，指向生成的资源文件路径

最后的构建就真的是太繁琐了，勾选，点击，勾选，点击，比以前烦多了

这里是跳到PAAS平台构建发布的，因为sit、test环境都是以前配好的，除了生产环境

好歹构建开始了，构建成功后可以把包下载下来解压查看文件的hash值，看是否和构建日志的一样，

这里报了两次错，一次是package的命令没写，一次是环境变量没配

成功之后直接可以发布了，可以勾选指定的服务器，

虽然全程没有操作，但是基本上下周自己的项目迁移问题不大了，晚上下班前把项目名和路径一起打包发给同事，帮忙创建项目



```
